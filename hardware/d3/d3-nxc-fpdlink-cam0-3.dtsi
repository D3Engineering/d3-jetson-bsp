/*
 * Copyright (c) 2020, D3 Engineering. All rights reserved.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; version 2 of the License.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for
 * more details.
 */

#include "d3-reset-full.dtsi"

/* UB960Q */
#define DES_NODE ub960_0
#define DES_PATH /proc/device-tree/i2c@3180000/tca9546@77/i2c@0/ub960@30

&i2c_mux_bus_0 {
	DES_NODE: ub960@30 {
		status = "okay";
		compatible = "d3,ub960";
		reg = <0x30>;
		#address-cells = <1>;
		#size-cells = <0>;
		//TODO find these
		iovdd-supply = <&p3668_vdd_1v8_sd>;
		avdd-supply = <&p3668_vdd_1v8_sd>;
		//TODO check this actually is correct
		pdb-gpios = <&nxc_fg 94 GPIO_ACTIVE_LOW>;
		csi-lane-count = <4>;
		csi-tx-speed-mbps = <1600>;
		csi-continuous-clock = <1>;
		CONCAT_2(DES_NODE,_link0): link@0 {
			status = "okay";
			reg = <0>;
			#address-cells = <1>;
			#size-cells = <0>;
		};
		CONCAT_2(DES_NODE,_link1): link@1 {
			status = "okay";
			reg = <1>;
			#address-cells = <1>;
			#size-cells = <0>;
		};
		CONCAT_2(DES_NODE,_link2): link@2 {
			status = "okay";
			reg = <2>;
			#address-cells = <1>;
			#size-cells = <0>;
		};
		CONCAT_2(DES_NODE,_link3): link@3 {
			status = "okay";
			reg = <3>;
			#address-cells = <1>;
			#size-cells = <0>;
		};
	};
};

#define STATUS disabled
#define ORIENTATION 1
#define TEGRA_SINTERFACE serial_a
#define VI_INPUT_STREAM 0
#define EEPROM_ADDR 54
#define CSI_PORT 0
#define CSI_LANES 4
#define IMG_BUS 11

/* Port 0 */
#include "d3-reset-port.dtsi"

/* UB953 */
#define DES_LINK 0
#define IMG_ADDR 10
#define SER_ADDR 40
/* camera node setup */
#define PORT_VCID 0
#define PORT_IDX 0
#define POSITION 0
#define DES_LINK 0
#define ENDPOINT_A 0
#define ENDPOINT_B 1
#define POC_SUPPLY <&poc0_vdd>

#include "d3-nxc-fpdlink-cameras.dtsi"

/* Port 1 */
#include "d3-reset-port.dtsi"

/* UB953 */
#define DES_LINK 1
#define IMG_ADDR 11
#define SER_ADDR 41
/* camera node setup */
#define PORT_VCID 1
#define PORT_IDX 1
#define POSITION 1
#define DES_LINK 1
#define ENDPOINT_A 2
#define ENDPOINT_B 3
#define POC_SUPPLY <&poc1_vdd>

#include "d3-nxc-fpdlink-cameras.dtsi"

/* Port 2 */
#include "d3-reset-port.dtsi"

/* UB953 */
#define DES_LINK 2
#define IMG_ADDR 12
#define SER_ADDR 42
/* camera node setup */
#define PORT_VCID 2
#define PORT_IDX 2
#define POSITION 2
#define DES_LINK 2
#define ENDPOINT_A 4
#define ENDPOINT_B 5
#define POC_SUPPLY <&poc2_vdd>

#include "d3-nxc-fpdlink-cameras.dtsi"

/* Port 3 */
#include "d3-reset-port.dtsi"

/* UB953 */
#define DES_LINK 3
#define IMG_ADDR 13
#define SER_ADDR 43
/* camera node setup */
#define PORT_VCID 3
#define PORT_IDX 3
#define POSITION 3
#define DES_LINK 3
#define ENDPOINT_A 6
#define ENDPOINT_B 7
#define POC_SUPPLY <&poc3_vdd>

#include "d3-nxc-fpdlink-cameras.dtsi"
